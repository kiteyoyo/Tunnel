function t=prediction(tropic, is_N)

if is_N
    location=[30.1,29.843,28.42,27.779,27.468,27.056,26.705,26.3,26.007,25.652,25.31,24.952,24.677,24.264,23.911,23.568,23.209,22.859,22.51,22.158,21.808,21.444,21.055,20.752,20.412,20.062,19.689,19.361,19.012,18.662,18.313,17.998,17.608,17.268,16.9,16.57,16.196,15.855,15.488,14.8,14.683,14.583,14.55,13.763,13.348,12.922,12.579,12.238,11.896,11.555,11.178,10.866,10.506,10.147,9.84,9.373,9.013,8.703,8.043,7.636,7.113,6.413,5.883,5.523,4.46,4.455,4.4,4.058,4.044,3.198,2.849,2.455,2.068,1.788,1.435,1.068,0.706,0.178];
else
    location=[1.072,1.424,1.766,2.05,2.433,2.835,3.178,3.506,3.806,4.016,4.178,4.395,4.749,5.523,6.498,7.113,7.553,7.923,8.669,9.063,9.326,9.84,10.145,10.495,10.845,11.158,11.545,11.895,12.245,12.595,12.945,13.343,14.356,14.483,14.54,14.691,15.139,15.478,15.856,16.201,16.551,16.902,17.253,17.608,17.99,18.312,18.663,19.013,19.363,19.677,20.063,20.413,20.763,21.063,21.46,21.807,22.159,22.506,22.859,23.207,23.56,23.91,24.264,24.678,24.962,25.312,25.664,26.013,26.299,26.706,27.054,27.442,27.748,28.236,29.716,30.14,30.249,30.266];
end
[s1 s2]=size(location);
t=0;
for i=1:(s2-1)
    dx=(location(i+1)+location(i))/2;
    if is_N
        if i<41
            v=([ dx t 1 ]*tropic(:,1));
        elseif i<43
            v1=([ dx t 1 ]*tropic(:,1));
            v2=([ dx t 1 ]*tropic(:,2));
            v=(v1+v2)/2;
        elseif i<66
            v=([ dx t 1 ]*tropic(:,2));
        elseif i<70
            v1=([ dx t 1 ]*tropic(:,2));
            v2=([ dx t 1 ]*tropic(:,3));
            v=(v1+v2)/2;
        else
            v=([ dx t 1 ]*tropic(:,3));
        end
    else
        if i>36
            v=([ dx t 1 ]*tropic(:,1));
        elseif i>32
            v1=([ dx t 1 ]*tropic(:,1));
            v2=([ dx t 1 ]*tropic(:,2));
            v=(v1+v2)/2;
        elseif i>11
            v=([ dx t 1 ]*tropic(:,2));
        elseif i>8
            v1=([ dx t 1 ]*tropic(:,2));
            v2=([ dx t 1 ]*tropic(:,3));
            v=(v1+v2)/2;
        else
            v=([ dx t 1 ]*tropic(:,3));
        end
    end
    dt=(location(i+1)-location(i))/v*60;
    if is_N
        t=t-dt;
    else
        t=t+dt;
    end
    fprintf('%d, dx=%d, v=%d, t=%d\n', i, dx, v, t)
end
